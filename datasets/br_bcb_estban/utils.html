<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>pipelines.datasets.br_bcb_estban.utils API documentation</title>
<meta name="description" content="General purpose functions for the br_bcb_estban project" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pipelines.datasets.br_bcb_estban.utils</code></h1>
</header>
<section id="section-intro">
<p>General purpose functions for the br_bcb_estban project</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
&#34;&#34;&#34;
General purpose functions for the br_bcb_estban project
&#34;&#34;&#34;
import requests
from lxml import html
import basedosdados as bd
from io import BytesIO
from zipfile import ZipFile
from urllib.request import urlopen
import pandas as pd
import unicodedata
import numpy as np
import re
import os

# ------- macro etapa 1 download de dados


def extract_download_links(url, xpath):
    &#34;&#34;&#34;this function extract all download links from bcb agencias website

    Args:
        url (_type_): _description_
        xpath (_type_): _description_

    Returns:
        _type_: _description_
    &#34;&#34;&#34;

    &#34;&#34;&#34;extract all download links from bcb agencias website

    Args:
        url (str): bcb url https://www.bcb.gov.br/fis/info/agencias.asp?frame=1
        xpath (str): xpath which contais donwload links

    Returns:
        list: a list of file links
    &#34;&#34;&#34;
    # Send a GET request to the URL
    response = requests.get(url)

    # Parse the HTML content of the response using lxml
    tree = html.fromstring(response.content)

    # Extract all the values from the given XPath
    values = tree.xpath(xpath + &#34;/option/@value&#34;)

    return values


def download_and_unzip(url, path):

    &#34;&#34;&#34;download and unzip a zip file

    Args:
        url (str): a url


    Returns:
        list: unziped files in a given folder
    &#34;&#34;&#34;

    os.system(f&#34;mkdir -p {path}&#34;)

    http_response = urlopen(url)
    zipfile = ZipFile(BytesIO(http_response.read()))
    zipfile.extractall(path=path)

    return path


# ------- macro etapa 2 tratamento de dados
# --- read files
def read_files(path: str) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function read a file from a given path

    Args:
        path (str): a path to a file

    Returns:
        pd.DataFrame: a dataframe with the file data
    &#34;&#34;&#34;
    df = pd.read_csv(
        path,
        sep=&#34;;&#34;,
        index_col=None,
        encoding=&#34;latin-1&#34;,
        skipfooter=2,
        skiprows=2,
        dtype={&#34;CNPJ&#34;: str, &#34;CODMUN&#34;: str},
    )

    return df


# ---1. rename columns
def rename_columns_municipio(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;this function rename columns from municipio dataframe

    Returns:
        dict: dict with old and new column names
    &#34;&#34;&#34;
    dict = {
        &#34;#DATA_BASE&#34;: &#34;data_base&#34;,
        &#34;UF&#34;: &#34;sigla_uf&#34;,
        &#34;CNPJ&#34;: &#34;cnpj_basico&#34;,
        &#34;NOME_INSTITUICAO&#34;: &#34;instituicao&#34;,
        &#34;AGEN_ESPERADAS&#34;: &#34;agencias_esperadas&#34;,
        &#34;AGEN_PROCESSADAS&#34;: &#34;agencias_processadas&#34;,
    }

    df = df.rename(columns=dict)

    return df


def rename_columns_agencia(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;this function rename columns from municipio dataframe

    Returns:
        dict: dict with old and new column names
    &#34;&#34;&#34;
    dict = {
        &#34;#DATA_BASE&#34;: &#34;data_base&#34;,
        &#34;UF&#34;: &#34;sigla_uf&#34;,
        &#34;CNPJ&#34;: &#34;cnpj_basico&#34;,
        &#34;NOME_INSTITUICAO&#34;: &#34;instituicao&#34;,
        &#34;AGENCIA&#34;: &#34;cnpj_agencia&#34;,
    }

    df = df.rename(columns=dict)

    return df


# ---2 remove accents from a string
# clean_dataframe and remove_columns_accents from pipelines.utils.utils
# will be used
# change inputs


def pre_cleaning_for_pivot_long_municipio(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function drop and rename columns before the pivoting operation
    performed by the wide_to_long function.

    Args:
        df (pd.DataFrame): a dataframe estban data

    Returns:
        pd.Dataframe: _description_
    &#34;&#34;&#34;
    df.drop(columns={&#34;MUNICIPIO&#34;, &#34;CODMUN_IBGE&#34;, &#34;CODMUN&#34;}, axis=1, inplace=True)
    df.rename(
        columns={
            &#34;#DATA_BASE&#34;: &#34;data_base&#34;,
            &#34;UF&#34;: &#34;sigla_uf&#34;,
            &#34;CNPJ&#34;: &#34;cnpj_basico&#34;,
            &#34;NOME_INSTITUICAO&#34;: &#34;instituicao&#34;,
            &#34;AGEN_ESPERADAS&#34;: &#34;agencias_esperadas&#34;,
            &#34;AGEN_PROCESSADAS&#34;: &#34;agencias_processadas&#34;,
        },
        axis=1,
        inplace=True,
    )

    return df


def pre_cleaning_for_pivot_long_agencia(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function drop and rename columns before the pivoting operation
    performed by the wide_to_long function.

    Args:
        df (pd.DataFrame): a dataframe estban data

    Returns:
        pd.Dataframe: _description_
    &#34;&#34;&#34;
    df.drop(columns={&#34;MUNICIPIO&#34;, &#34;CODMUN_IBGE&#34;, &#34;CODMUN&#34;}, axis=1, inplace=True)
    df.rename(
        columns={
            &#34;#DATA_BASE&#34;: &#34;data_base&#34;,
            &#34;UF&#34;: &#34;sigla_uf&#34;,
            &#34;CNPJ&#34;: &#34;cnpj_basico&#34;,
            &#34;NOME_INSTITUICAO&#34;: &#34;instituicao&#34;,
            # todo : change cnpj_agencia to cnpj
            &#34;AGENCIA&#34;: &#34;cnpj_agencia&#34;,
        },
        axis=1,
        inplace=True,
    )

    pattern = re.compile(r&#34;(&#39;)&#34;)

    df[&#34;cnpj_agencia&#34;] = [pattern.sub(&#34;&#34;, x) for x in df[&#34;cnpj_agencia&#34;]]

    return df


def create_id_municipio(df: pd.DataFrame, df2: dict) -&gt; pd.DataFrame:
    &#34;&#34;&#34;this function creates a id_municipio column

    Args:
        df (pd.DataFrame): A ESTBAN dataset
        df2 (dict): with id_municipio_bcb as key  and id_municipio as value

    Returns:
        pd.DataFrame: Estban dataset with id_municipio column
    &#34;&#34;&#34;

    df[&#34;id_municipio&#34;] = df.CODMUN.map(df2)

    return df


# todo: to func: do wide para o long
def wide_to_long_municipio(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;Pivot verbete columns to long format

    Args:
        df (pd.DataFrame): _description_

    Returns:
        pd.DataFrame: _description_
    &#34;&#34;&#34;
    df = df.melt(
        id_vars=[
            &#34;data_base&#34;,
            &#34;sigla_uf&#34;,
            &#34;cnpj_basico&#34;,
            &#34;instituicao&#34;,
            &#34;agencias_esperadas&#34;,
            &#34;agencias_processadas&#34;,
            &#34;id_municipio&#34;,
        ],
        var_name=&#34;verbete_descricao&#34;,
        value_name=&#34;valor&#34;,
    )

    return df


def wide_to_long_agencia(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;Pivot verbete columns to long format

    Args:
        df (pd.DataFrame): _description_

    Returns:
        pd.DataFrame: _description_
    &#34;&#34;&#34;
    df = df.melt(
        id_vars=[
            &#34;data_base&#34;,
            &#34;sigla_uf&#34;,
            &#34;cnpj_basico&#34;,
            &#34;instituicao&#34;,
            &#34;cnpj_agencia&#34;,
            &#34;id_municipio&#34;,
        ],
        var_name=&#34;verbete_descricao&#34;,
        value_name=&#34;valor&#34;,
    )

    return df


# todo: to func:corrige unidades monetárias
def condicoes(database, valor) -&gt; None:
    # cruzado
    if database &lt;= 198812:
        return round(valor / (1000**2 * 2750), 6)
    # cruzado novo
    elif database &gt;= 198901 and database &lt;= 199002:
        return round(valor / (1000 * 2750), 4)
    # cruzeiro
    elif database &gt;= 199003 and database &lt;= 199307:
        return round(valor / (1000 * 2750), 4)
    # cruzeiro real
    elif database &gt; 199307 and database &lt;= 199406:
        return round(valor / (2750), 2)
    # real
    else:
        return round(valor, 0)


# todo: not str types. they&#39;re arrays i think
def standardize_monetary_units(
    df: pd.DataFrame, date_column, value_column
) -&gt; pd.DataFrame:

    &#34;&#34;&#34;This function corrects monetary units from ESTBAN files.
    It relies on the data_base column being a string in the format YYYYMM,
    where YYYY is the year and MM is the month.&#34;&#34;&#34;

    # todo: check the logic
    database = df[f&#34;{date_column}&#34;]
    valor = df[f&#34;{value_column}&#34;]

    # Calling the condicoes function from above
    condicoes_vetorizada = np.vectorize(condicoes)

    df[&#34;valor&#34;] = condicoes_vetorizada(database, valor)  # trocar para valor

    return df


# todo: to func:extrai os ids dos verbetes
def create_id_verbete_column(df: pd.DataFrame, column_name: str) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function creates id_verbete column from a verbete column.
    It parses numeric digitis from the verbete column strings.

    Args:
        df (pd.DataFrame): _description_
        verbete_column (str): _description_

    Returns:
        pd.Dataframe: _description_
    &#34;&#34;&#34;
    padrao_letras = re.compile(r&#34;\D&#34;)

    df[column_name] = [padrao_letras.sub(&#34;&#34;, x) for x in df[&#34;verbete_descricao&#34;]]

    return df


# todo: to func:criar ano e mes
# criar ano e mes
def create_month_year_columns(df: pd.DataFrame, date_column: str) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function creates month and year columns from a date column.
    It Relies on the date column being a string in the format YYYYMM,
    where YYYY is the year and MM is the month.
    # todo: introduce some kind of check to the date column from estban files

    Args:
        df (pd.DataFrame): a ESTBAN municipios or agencia file
        date_column (_type_): the date column from ESTBAN files being a string in the format YYYYMM

    Returns:
        pd.Dataframe: the same dataframe with the new columns
    &#34;&#34;&#34;
    df[&#34;ano&#34;] = df[date_column].astype(str).str.slice(0, 4)
    df[&#34;mes&#34;] = df[date_column].astype(str).str.slice(4)

    return df


def order_cols_municipio(df: pd.DataFrame) -&gt; pd.DataFrame:

    &#34;&#34;&#34;this function orders the columns of the dataframe

    Returns:
        pd.DataFrame: ordered columns
    &#34;&#34;&#34;
    order = [
        &#34;ano&#34;,
        &#34;mes&#34;,
        &#34;sigla_uf&#34;,
        &#34;id_municipio&#34;,
        &#34;cnpj_basico&#34;,
        &#34;instituicao&#34;,
        &#34;agencias_esperadas&#34;,
        &#34;agencias_processadas&#34;,
        &#34;id_verbete&#34;,
        &#34;valor&#34;,
    ]

    df = df[order]

    return df


def cols_order_agencia(df: pd.DataFrame) -&gt; pd.DataFrame:

    &#34;&#34;&#34;this function orders the columns of the dataframe

    Returns:
        pd.DataFrame: ordered columns
    &#34;&#34;&#34;
    order = [
        &#34;ano&#34;,
        &#34;mes&#34;,
        &#34;sigla_uf&#34;,
        &#34;id_municipio&#34;,
        &#34;cnpj_basico&#34;,
        &#34;instituicao&#34;,
        &#34;cnpj_agencia&#34;,
        &#34;id_verbete&#34;,
        &#34;valor&#34;,
    ]

    df = df[order]

    return df


# function copied from datasets.br_tse_eleicoes.utils
def get_data_from_prod(dataset_id: str, table_id: str, columns: list) -&gt; list:
    &#34;&#34;&#34;
    Get select columns from a table in prod.
    &#34;&#34;&#34;

    storage = bd.Storage(dataset_id=dataset_id, table_id=table_id)
    blobs = list(
        storage.client[&#34;storage_staging&#34;]
        .bucket(&#34;basedosdados-dev&#34;)
        .list_blobs(prefix=f&#34;staging/{storage.dataset_id}/{storage.table_id}/&#34;)
    )

    dfs = []

    for blob in blobs:
        partitions = re.findall(r&#34;\w+(?==)&#34;, blob.name)
        if len(set(partitions) &amp; set(columns)) == 0:
            df = pd.read_csv(
                blob.public_url,
                usecols=columns,
                dtype={&#34;id_municipio&#34;: str, &#34;id_municipio_bcb&#34;: str},
            )
            dfs.append(df)
        else:
            columns2add = list(set(partitions) &amp; set(columns))
            for column in columns2add:
                columns.remove(column)
            df = pd.read_csv(
                blob.public_url,
                usecols=columns,
                dtype={&#34;id_municipio&#34;: str, &#34;id_municipio_bcb&#34;: str},
            )
            for column in columns2add:
                df[column] = blob.name.split(column + &#34;=&#34;)[1].split(&#34;/&#34;)[0]
            dfs.append(df)

    df = pd.concat(dfs)

    return df</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pipelines.datasets.br_bcb_estban.utils.cols_order_agencia"><code class="name flex">
<span>def <span class="ident">cols_order_agencia</span></span>(<span>df: pandas.core.frame.DataFrame) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>this function orders the columns of the dataframe</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code></dt>
<dd>ordered columns</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def cols_order_agencia(df: pd.DataFrame) -&gt; pd.DataFrame:

    &#34;&#34;&#34;this function orders the columns of the dataframe

    Returns:
        pd.DataFrame: ordered columns
    &#34;&#34;&#34;
    order = [
        &#34;ano&#34;,
        &#34;mes&#34;,
        &#34;sigla_uf&#34;,
        &#34;id_municipio&#34;,
        &#34;cnpj_basico&#34;,
        &#34;instituicao&#34;,
        &#34;cnpj_agencia&#34;,
        &#34;id_verbete&#34;,
        &#34;valor&#34;,
    ]

    df = df[order]

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.condicoes"><code class="name flex">
<span>def <span class="ident">condicoes</span></span>(<span>database, valor) ‑> None</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def condicoes(database, valor) -&gt; None:
    # cruzado
    if database &lt;= 198812:
        return round(valor / (1000**2 * 2750), 6)
    # cruzado novo
    elif database &gt;= 198901 and database &lt;= 199002:
        return round(valor / (1000 * 2750), 4)
    # cruzeiro
    elif database &gt;= 199003 and database &lt;= 199307:
        return round(valor / (1000 * 2750), 4)
    # cruzeiro real
    elif database &gt; 199307 and database &lt;= 199406:
        return round(valor / (2750), 2)
    # real
    else:
        return round(valor, 0)</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.create_id_municipio"><code class="name flex">
<span>def <span class="ident">create_id_municipio</span></span>(<span>df: pandas.core.frame.DataFrame, df2: dict) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>this function creates a id_municipio column</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>df</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>A ESTBAN dataset</dd>
<dt><strong><code>df2</code></strong> :&ensp;<code>dict</code></dt>
<dd>with id_municipio_bcb as key
and id_municipio as value</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code></dt>
<dd>Estban dataset with id_municipio column</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_id_municipio(df: pd.DataFrame, df2: dict) -&gt; pd.DataFrame:
    &#34;&#34;&#34;this function creates a id_municipio column

    Args:
        df (pd.DataFrame): A ESTBAN dataset
        df2 (dict): with id_municipio_bcb as key  and id_municipio as value

    Returns:
        pd.DataFrame: Estban dataset with id_municipio column
    &#34;&#34;&#34;

    df[&#34;id_municipio&#34;] = df.CODMUN.map(df2)

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.create_id_verbete_column"><code class="name flex">
<span>def <span class="ident">create_id_verbete_column</span></span>(<span>df: pandas.core.frame.DataFrame, column_name: str) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>This function creates id_verbete column from a verbete column.
It parses numeric digitis from the verbete column strings.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>df</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd><em>description</em></dd>
<dt><strong><code>verbete_column</code></strong> :&ensp;<code>str</code></dt>
<dd><em>description</em></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.Dataframe</code></dt>
<dd><em>description</em></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_id_verbete_column(df: pd.DataFrame, column_name: str) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function creates id_verbete column from a verbete column.
    It parses numeric digitis from the verbete column strings.

    Args:
        df (pd.DataFrame): _description_
        verbete_column (str): _description_

    Returns:
        pd.Dataframe: _description_
    &#34;&#34;&#34;
    padrao_letras = re.compile(r&#34;\D&#34;)

    df[column_name] = [padrao_letras.sub(&#34;&#34;, x) for x in df[&#34;verbete_descricao&#34;]]

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.create_month_year_columns"><code class="name flex">
<span>def <span class="ident">create_month_year_columns</span></span>(<span>df: pandas.core.frame.DataFrame, date_column: str) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>This function creates month and year columns from a date column.
It Relies on the date column being a string in the format YYYYMM,
where YYYY is the year and MM is the month.</p>
<h1 id="todo-introduce-some-kind-of-check-to-the-date-column-from-estban-files">todo: introduce some kind of check to the date column from estban files</h1>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>df</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>a ESTBAN municipios or agencia file</dd>
<dt><strong><code>date_column</code></strong> :&ensp;<code>_type_</code></dt>
<dd>the date column from ESTBAN files being a string in the format YYYYMM</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.Dataframe</code></dt>
<dd>the same dataframe with the new columns</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_month_year_columns(df: pd.DataFrame, date_column: str) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function creates month and year columns from a date column.
    It Relies on the date column being a string in the format YYYYMM,
    where YYYY is the year and MM is the month.
    # todo: introduce some kind of check to the date column from estban files

    Args:
        df (pd.DataFrame): a ESTBAN municipios or agencia file
        date_column (_type_): the date column from ESTBAN files being a string in the format YYYYMM

    Returns:
        pd.Dataframe: the same dataframe with the new columns
    &#34;&#34;&#34;
    df[&#34;ano&#34;] = df[date_column].astype(str).str.slice(0, 4)
    df[&#34;mes&#34;] = df[date_column].astype(str).str.slice(4)

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.download_and_unzip"><code class="name flex">
<span>def <span class="ident">download_and_unzip</span></span>(<span>url, path)</span>
</code></dt>
<dd>
<div class="desc"><p>download and unzip a zip file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>url</code></strong> :&ensp;<code>str</code></dt>
<dd>a url</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>unziped files in a given folder</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def download_and_unzip(url, path):

    &#34;&#34;&#34;download and unzip a zip file

    Args:
        url (str): a url


    Returns:
        list: unziped files in a given folder
    &#34;&#34;&#34;

    os.system(f&#34;mkdir -p {path}&#34;)

    http_response = urlopen(url)
    zipfile = ZipFile(BytesIO(http_response.read()))
    zipfile.extractall(path=path)

    return path</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.extract_download_links"><code class="name flex">
<span>def <span class="ident">extract_download_links</span></span>(<span>url, xpath)</span>
</code></dt>
<dd>
<div class="desc"><p>this function extract all download links from bcb agencias website</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>url</code></strong> :&ensp;<code>_type_</code></dt>
<dd><em>description</em></dd>
<dt><strong><code>xpath</code></strong> :&ensp;<code>_type_</code></dt>
<dd><em>description</em></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>_type_</code></dt>
<dd><em>description</em></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extract_download_links(url, xpath):
    &#34;&#34;&#34;this function extract all download links from bcb agencias website

    Args:
        url (_type_): _description_
        xpath (_type_): _description_

    Returns:
        _type_: _description_
    &#34;&#34;&#34;

    &#34;&#34;&#34;extract all download links from bcb agencias website

    Args:
        url (str): bcb url https://www.bcb.gov.br/fis/info/agencias.asp?frame=1
        xpath (str): xpath which contais donwload links

    Returns:
        list: a list of file links
    &#34;&#34;&#34;
    # Send a GET request to the URL
    response = requests.get(url)

    # Parse the HTML content of the response using lxml
    tree = html.fromstring(response.content)

    # Extract all the values from the given XPath
    values = tree.xpath(xpath + &#34;/option/@value&#34;)

    return values</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.get_data_from_prod"><code class="name flex">
<span>def <span class="ident">get_data_from_prod</span></span>(<span>dataset_id: str, table_id: str, columns: list) ‑> list</span>
</code></dt>
<dd>
<div class="desc"><p>Get select columns from a table in prod.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_data_from_prod(dataset_id: str, table_id: str, columns: list) -&gt; list:
    &#34;&#34;&#34;
    Get select columns from a table in prod.
    &#34;&#34;&#34;

    storage = bd.Storage(dataset_id=dataset_id, table_id=table_id)
    blobs = list(
        storage.client[&#34;storage_staging&#34;]
        .bucket(&#34;basedosdados-dev&#34;)
        .list_blobs(prefix=f&#34;staging/{storage.dataset_id}/{storage.table_id}/&#34;)
    )

    dfs = []

    for blob in blobs:
        partitions = re.findall(r&#34;\w+(?==)&#34;, blob.name)
        if len(set(partitions) &amp; set(columns)) == 0:
            df = pd.read_csv(
                blob.public_url,
                usecols=columns,
                dtype={&#34;id_municipio&#34;: str, &#34;id_municipio_bcb&#34;: str},
            )
            dfs.append(df)
        else:
            columns2add = list(set(partitions) &amp; set(columns))
            for column in columns2add:
                columns.remove(column)
            df = pd.read_csv(
                blob.public_url,
                usecols=columns,
                dtype={&#34;id_municipio&#34;: str, &#34;id_municipio_bcb&#34;: str},
            )
            for column in columns2add:
                df[column] = blob.name.split(column + &#34;=&#34;)[1].split(&#34;/&#34;)[0]
            dfs.append(df)

    df = pd.concat(dfs)

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.order_cols_municipio"><code class="name flex">
<span>def <span class="ident">order_cols_municipio</span></span>(<span>df: pandas.core.frame.DataFrame) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>this function orders the columns of the dataframe</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code></dt>
<dd>ordered columns</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def order_cols_municipio(df: pd.DataFrame) -&gt; pd.DataFrame:

    &#34;&#34;&#34;this function orders the columns of the dataframe

    Returns:
        pd.DataFrame: ordered columns
    &#34;&#34;&#34;
    order = [
        &#34;ano&#34;,
        &#34;mes&#34;,
        &#34;sigla_uf&#34;,
        &#34;id_municipio&#34;,
        &#34;cnpj_basico&#34;,
        &#34;instituicao&#34;,
        &#34;agencias_esperadas&#34;,
        &#34;agencias_processadas&#34;,
        &#34;id_verbete&#34;,
        &#34;valor&#34;,
    ]

    df = df[order]

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.pre_cleaning_for_pivot_long_agencia"><code class="name flex">
<span>def <span class="ident">pre_cleaning_for_pivot_long_agencia</span></span>(<span>df: pandas.core.frame.DataFrame) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>This function drop and rename columns before the pivoting operation
performed by the wide_to_long function.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>df</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>a dataframe estban data</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.Dataframe</code></dt>
<dd><em>description</em></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def pre_cleaning_for_pivot_long_agencia(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function drop and rename columns before the pivoting operation
    performed by the wide_to_long function.

    Args:
        df (pd.DataFrame): a dataframe estban data

    Returns:
        pd.Dataframe: _description_
    &#34;&#34;&#34;
    df.drop(columns={&#34;MUNICIPIO&#34;, &#34;CODMUN_IBGE&#34;, &#34;CODMUN&#34;}, axis=1, inplace=True)
    df.rename(
        columns={
            &#34;#DATA_BASE&#34;: &#34;data_base&#34;,
            &#34;UF&#34;: &#34;sigla_uf&#34;,
            &#34;CNPJ&#34;: &#34;cnpj_basico&#34;,
            &#34;NOME_INSTITUICAO&#34;: &#34;instituicao&#34;,
            # todo : change cnpj_agencia to cnpj
            &#34;AGENCIA&#34;: &#34;cnpj_agencia&#34;,
        },
        axis=1,
        inplace=True,
    )

    pattern = re.compile(r&#34;(&#39;)&#34;)

    df[&#34;cnpj_agencia&#34;] = [pattern.sub(&#34;&#34;, x) for x in df[&#34;cnpj_agencia&#34;]]

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.pre_cleaning_for_pivot_long_municipio"><code class="name flex">
<span>def <span class="ident">pre_cleaning_for_pivot_long_municipio</span></span>(<span>df: pandas.core.frame.DataFrame) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>This function drop and rename columns before the pivoting operation
performed by the wide_to_long function.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>df</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>a dataframe estban data</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.Dataframe</code></dt>
<dd><em>description</em></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def pre_cleaning_for_pivot_long_municipio(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function drop and rename columns before the pivoting operation
    performed by the wide_to_long function.

    Args:
        df (pd.DataFrame): a dataframe estban data

    Returns:
        pd.Dataframe: _description_
    &#34;&#34;&#34;
    df.drop(columns={&#34;MUNICIPIO&#34;, &#34;CODMUN_IBGE&#34;, &#34;CODMUN&#34;}, axis=1, inplace=True)
    df.rename(
        columns={
            &#34;#DATA_BASE&#34;: &#34;data_base&#34;,
            &#34;UF&#34;: &#34;sigla_uf&#34;,
            &#34;CNPJ&#34;: &#34;cnpj_basico&#34;,
            &#34;NOME_INSTITUICAO&#34;: &#34;instituicao&#34;,
            &#34;AGEN_ESPERADAS&#34;: &#34;agencias_esperadas&#34;,
            &#34;AGEN_PROCESSADAS&#34;: &#34;agencias_processadas&#34;,
        },
        axis=1,
        inplace=True,
    )

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.read_files"><code class="name flex">
<span>def <span class="ident">read_files</span></span>(<span>path: str) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>This function read a file from a given path</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>a path to a file</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code></dt>
<dd>a dataframe with the file data</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def read_files(path: str) -&gt; pd.DataFrame:
    &#34;&#34;&#34;This function read a file from a given path

    Args:
        path (str): a path to a file

    Returns:
        pd.DataFrame: a dataframe with the file data
    &#34;&#34;&#34;
    df = pd.read_csv(
        path,
        sep=&#34;;&#34;,
        index_col=None,
        encoding=&#34;latin-1&#34;,
        skipfooter=2,
        skiprows=2,
        dtype={&#34;CNPJ&#34;: str, &#34;CODMUN&#34;: str},
    )

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.rename_columns_agencia"><code class="name flex">
<span>def <span class="ident">rename_columns_agencia</span></span>(<span>df: pandas.core.frame.DataFrame) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>this function rename columns from municipio dataframe</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>dict with old and new column names</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def rename_columns_agencia(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;this function rename columns from municipio dataframe

    Returns:
        dict: dict with old and new column names
    &#34;&#34;&#34;
    dict = {
        &#34;#DATA_BASE&#34;: &#34;data_base&#34;,
        &#34;UF&#34;: &#34;sigla_uf&#34;,
        &#34;CNPJ&#34;: &#34;cnpj_basico&#34;,
        &#34;NOME_INSTITUICAO&#34;: &#34;instituicao&#34;,
        &#34;AGENCIA&#34;: &#34;cnpj_agencia&#34;,
    }

    df = df.rename(columns=dict)

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.rename_columns_municipio"><code class="name flex">
<span>def <span class="ident">rename_columns_municipio</span></span>(<span>df: pandas.core.frame.DataFrame) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>this function rename columns from municipio dataframe</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>dict with old and new column names</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def rename_columns_municipio(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;this function rename columns from municipio dataframe

    Returns:
        dict: dict with old and new column names
    &#34;&#34;&#34;
    dict = {
        &#34;#DATA_BASE&#34;: &#34;data_base&#34;,
        &#34;UF&#34;: &#34;sigla_uf&#34;,
        &#34;CNPJ&#34;: &#34;cnpj_basico&#34;,
        &#34;NOME_INSTITUICAO&#34;: &#34;instituicao&#34;,
        &#34;AGEN_ESPERADAS&#34;: &#34;agencias_esperadas&#34;,
        &#34;AGEN_PROCESSADAS&#34;: &#34;agencias_processadas&#34;,
    }

    df = df.rename(columns=dict)

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.standardize_monetary_units"><code class="name flex">
<span>def <span class="ident">standardize_monetary_units</span></span>(<span>df: pandas.core.frame.DataFrame, date_column, value_column) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>This function corrects monetary units from ESTBAN files.
It relies on the data_base column being a string in the format YYYYMM,
where YYYY is the year and MM is the month.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def standardize_monetary_units(
    df: pd.DataFrame, date_column, value_column
) -&gt; pd.DataFrame:

    &#34;&#34;&#34;This function corrects monetary units from ESTBAN files.
    It relies on the data_base column being a string in the format YYYYMM,
    where YYYY is the year and MM is the month.&#34;&#34;&#34;

    # todo: check the logic
    database = df[f&#34;{date_column}&#34;]
    valor = df[f&#34;{value_column}&#34;]

    # Calling the condicoes function from above
    condicoes_vetorizada = np.vectorize(condicoes)

    df[&#34;valor&#34;] = condicoes_vetorizada(database, valor)  # trocar para valor

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.wide_to_long_agencia"><code class="name flex">
<span>def <span class="ident">wide_to_long_agencia</span></span>(<span>df: pandas.core.frame.DataFrame) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>Pivot verbete columns to long format</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>df</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd><em>description</em></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code></dt>
<dd><em>description</em></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def wide_to_long_agencia(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;Pivot verbete columns to long format

    Args:
        df (pd.DataFrame): _description_

    Returns:
        pd.DataFrame: _description_
    &#34;&#34;&#34;
    df = df.melt(
        id_vars=[
            &#34;data_base&#34;,
            &#34;sigla_uf&#34;,
            &#34;cnpj_basico&#34;,
            &#34;instituicao&#34;,
            &#34;cnpj_agencia&#34;,
            &#34;id_municipio&#34;,
        ],
        var_name=&#34;verbete_descricao&#34;,
        value_name=&#34;valor&#34;,
    )

    return df</code></pre>
</details>
</dd>
<dt id="pipelines.datasets.br_bcb_estban.utils.wide_to_long_municipio"><code class="name flex">
<span>def <span class="ident">wide_to_long_municipio</span></span>(<span>df: pandas.core.frame.DataFrame) ‑> pandas.core.frame.DataFrame</span>
</code></dt>
<dd>
<div class="desc"><p>Pivot verbete columns to long format</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>df</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd><em>description</em></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code></dt>
<dd><em>description</em></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def wide_to_long_municipio(df: pd.DataFrame) -&gt; pd.DataFrame:
    &#34;&#34;&#34;Pivot verbete columns to long format

    Args:
        df (pd.DataFrame): _description_

    Returns:
        pd.DataFrame: _description_
    &#34;&#34;&#34;
    df = df.melt(
        id_vars=[
            &#34;data_base&#34;,
            &#34;sigla_uf&#34;,
            &#34;cnpj_basico&#34;,
            &#34;instituicao&#34;,
            &#34;agencias_esperadas&#34;,
            &#34;agencias_processadas&#34;,
            &#34;id_municipio&#34;,
        ],
        var_name=&#34;verbete_descricao&#34;,
        value_name=&#34;valor&#34;,
    )

    return df</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pipelines.datasets.br_bcb_estban" href="index.html">pipelines.datasets.br_bcb_estban</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.cols_order_agencia" href="#pipelines.datasets.br_bcb_estban.utils.cols_order_agencia">cols_order_agencia</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.condicoes" href="#pipelines.datasets.br_bcb_estban.utils.condicoes">condicoes</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.create_id_municipio" href="#pipelines.datasets.br_bcb_estban.utils.create_id_municipio">create_id_municipio</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.create_id_verbete_column" href="#pipelines.datasets.br_bcb_estban.utils.create_id_verbete_column">create_id_verbete_column</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.create_month_year_columns" href="#pipelines.datasets.br_bcb_estban.utils.create_month_year_columns">create_month_year_columns</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.download_and_unzip" href="#pipelines.datasets.br_bcb_estban.utils.download_and_unzip">download_and_unzip</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.extract_download_links" href="#pipelines.datasets.br_bcb_estban.utils.extract_download_links">extract_download_links</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.get_data_from_prod" href="#pipelines.datasets.br_bcb_estban.utils.get_data_from_prod">get_data_from_prod</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.order_cols_municipio" href="#pipelines.datasets.br_bcb_estban.utils.order_cols_municipio">order_cols_municipio</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.pre_cleaning_for_pivot_long_agencia" href="#pipelines.datasets.br_bcb_estban.utils.pre_cleaning_for_pivot_long_agencia">pre_cleaning_for_pivot_long_agencia</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.pre_cleaning_for_pivot_long_municipio" href="#pipelines.datasets.br_bcb_estban.utils.pre_cleaning_for_pivot_long_municipio">pre_cleaning_for_pivot_long_municipio</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.read_files" href="#pipelines.datasets.br_bcb_estban.utils.read_files">read_files</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.rename_columns_agencia" href="#pipelines.datasets.br_bcb_estban.utils.rename_columns_agencia">rename_columns_agencia</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.rename_columns_municipio" href="#pipelines.datasets.br_bcb_estban.utils.rename_columns_municipio">rename_columns_municipio</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.standardize_monetary_units" href="#pipelines.datasets.br_bcb_estban.utils.standardize_monetary_units">standardize_monetary_units</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.wide_to_long_agencia" href="#pipelines.datasets.br_bcb_estban.utils.wide_to_long_agencia">wide_to_long_agencia</a></code></li>
<li><code><a title="pipelines.datasets.br_bcb_estban.utils.wide_to_long_municipio" href="#pipelines.datasets.br_bcb_estban.utils.wide_to_long_municipio">wide_to_long_municipio</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>